(this["webpackJsonpb-spline-demos"]=this["webpackJsonpb-spline-demos"]||[]).push([[0],{171:function(e,t,n){e.exports=n(349)},176:function(e,t,n){},349:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(17),o=n.n(i),c=(n(176),n(112)),l=n(35),s=n(11),u=n(18),h=n.n(u),p=n(32),f=n(33),d=function(e,t){return 0===t?0:e/t},m=function(){function e(t,n){Object(p.a)(this,e),this.order=void 0,this.tArray=void 0,this.maxIndex=void 0,this.cache=new Map,this.polynomialArray=[],this.tArray=t,this.order=n,this.maxIndex=t.length-n;for(var r=0;r<n;r+=1)this.polynomialArray.push(new e(this.tArray,r))}return Object(f.a)(e,[{key:"get",value:function(e){if(e>this.maxIndex)return function(){return 0};var t=this.cache.get(e);return t||this.getPolynomialFunc(e)}},{key:"getPolynomialFunc",value:function(e){var t,n=this,r=this.tArray,a=this.order,i=this.polynomialArray[a-1];if(1===a)t=function(t){return t>=n.tArray[e]&&t<n.tArray[e+1]?1:0};else{var o=r[e+a-1]-r[e],c=r[e+a]-r[e+1];t=function(t){return d(t-r[e],o)*i.get(e)(t)+d(r[e+a]-t,c)*i.get(e+1)(t)}}return this.cache.set(e,t),t}}]),e}(),g=function(){function e(t){Object(p.a)(this,e),this.order=3,this.maxT=void 0,this.tArray=void 0,this.cPoints=void 0,this.tRange=void 0,this.bSplinePolynomial=void 0,this.cPoints=t,this.maxT=t.length+this.order,this.tArray=this.generateTArray(),this.tRange=[this.order-1,t.length],this.bSplinePolynomial=new m(this.tArray,this.order)}return Object(f.a)(e,[{key:"generateTArray",value:function(){for(var e=[],t=0;t<=this.maxT;t++)e.push(t);return e}},{key:"getPoints",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.05,n=Object(s.a)(this.tRange,2),r=n[0],a=n[1],i=this.cPoints.map((function(t,n){return e.bSplinePolynomial.get(n)})),o=[],c=function(t){var n=i.map((function(e){return e(t)}));o.push(e.cPoints.reduce((function(e,t,r){var a=Object(s.a)(e,2),i=a[0],o=a[1],c=Object(s.a)(t,2),l=c[0],u=c[1];return[i+l*n[r],o+u*n[r]]}),[0,0]))},l=r;l<=a;l+=t)c(l);return o}}]),e}(),v=[[50,10],[100,30],[200,60],[300,300],[150,200],[100,150],[50,100]];var y=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(null),n=Object(s.a)(t,2),i=n[0],o=n[1];return Object(r.useEffect)((function(){e.current&&null==i&&o(h.a.init(e.current,{renderer:"canvas"}))}),[e.current]),Object(r.useEffect)((function(){if(i){var e=new g(v).getPoints(),t=new h.a.Polyline({shape:{points:e}});i.add(t),v.forEach((function(e,n){var r=new h.a.Circle({shape:{cx:e[0],cy:e[1],r:3},draggable:!0});r.on("drag",(function(e){v[n]=[e.offsetX,e.offsetY];var r=new g(v).getPoints();t.shape.points=r,t.dirty()})),i.add(r)}))}}),[i]),a.a.createElement("div",{style:{padding:"32px 0"}},a.a.createElement("div",{style:{textAlign:"center",marginBottom:"32px"}},"\u5747\u5300\u4e09\u9636B\u6837\u6761\u66f2\u7ebf"),a.a.createElement("div",{ref:e,style:{width:"100%",height:"600px"}}))},b=function(){function e(t){if(Object(p.a)(this,e),this.order=void 0,this.points=void 0,this.tArray=void 0,this.bSplinePolynomial=void 0,this.order=t.order,this.points=t.points,this.tArray=t.tArray,this.order>this.points.length)throw new Error("the order(".concat(this.order,") cannot be greater than the length of control point(").concat(this.points.length,")."));if(this.order<2)throw new Error("order cannot be less than 2.");if(this.tArray.length!==this.points.length+this.order)throw new Error("the array length of parameter t (".concat(this.tArray.length,") must be equal to the sum of the length of points (").concat(this.points.length,") and the order (").concat(this.order,")."));this.bSplinePolynomial=new m(this.tArray,this.order)}return Object(f.a)(e,[{key:"getPoint",value:function(e){var t=this;return this.points.reduce((function(n,r,a){var i=Object(s.a)(n,2),o=i[0],c=i[1],l=Object(s.a)(r,2),u=l[0],h=l[1],p=t.bSplinePolynomial.get(a)(e);return[o+p*u,c+p*h]}),[0,0])}},{key:"updatePoint",value:function(e,t){if(e<0||e>this.points.length-1)throw new Error("parameter index error.");this.points[e]=t}}]),e}(),E=function(){function e(t,n){if(Object(p.a)(this,e),this.mutationPointIndexes=[],this.ratioCache=new Map,this.bSpline=void 0,n>t.length)throw new Error("the order(".concat(n,") cannot be greater than the length of control point(").concat(t.length,")."));if(n<2)throw new Error("order cannot be less than 2.");this.bSpline=new b({order:n,points:t,tArray:this.generateTArray(t,n)})}return Object(f.a)(e,[{key:"generateTArray",value:function(e,t){for(var n=[],r=e.length+t,a=0;a<r;a+=1)a<t?n.push(0):a<=e.length?n.push(a-t+1):n.push(e.length-t+1);return n}},{key:"getPoint",value:function(e){return this.bSpline.getPoint(e)}},{key:"updatePoint",value:function(e,t){if(e<0||e>this.bSpline.points.length-1)throw new Error("parameter index error.");this.bSpline.points[e]=t}}]),e}();var j=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(null),n=Object(s.a)(t,2),i=n[0],o=n[1];return Object(r.useEffect)((function(){e.current&&null==i&&o(h.a.init(e.current,{renderer:"canvas"}))}),[e.current]),Object(r.useEffect)((function(){if(i){for(var e=[[50,50],[100,70],[80,140],[100,200],[160,180],[200,200],[200,300],[300,200],[400,400]],t=new E(e,3),n=[],r=0;r<=t.bSpline.tArray[t.bSpline.tArray.length-1];r+=.01){var a=t.getPoint(r);n.push(a)}var o=new h.a.Polyline({shape:{points:n}});i.add(o),e.forEach((function(n,r){var a=new h.a.Circle({shape:{cx:n[0],cy:n[1],r:3},draggable:!0});a.on("drag",(function(n){var a=[n.offsetX,n.offsetY];e[r]=a,t.updatePoint(r,a);for(var i=[],c=0;c<=t.bSpline.tArray[t.bSpline.tArray.length-1];c+=.01){var l=t.getPoint(c);i.push(l)}o.shape.points=i,o.dirty()})),i.add(a)}))}}),[i]),a.a.createElement("div",{style:{padding:"32px 0"}},a.a.createElement("div",{style:{textAlign:"center",marginBottom:"32px"}},"\u5f00\u653e\u5747\u5300B\u6837\u6761\u66f2\u7ebf"),a.a.createElement("div",{ref:e,style:{width:"100%",height:"400px"}}))},O=(n(225),n(60));var w=function(){var e=Object(l.f)(),t=Object(l.g)();return a.a.createElement("div",{style:{padding:"16px"}},a.a.createElement("h1",{style:{textAlign:"center"}},"B\u6837\u6761\u66f2\u7ebf"),a.a.createElement(O.a.Group,{value:t.pathname,onChange:function(t){e.push(t.target.value)}},a.a.createElement(O.a.Button,{value:"/uniform-b-spline-of-order-3"},"\u5747\u53003\u9636B\u6837\u6761"),a.a.createElement(O.a.Button,{value:"/open-uniform-b-spline"},"\u5f00\u653e\u5747\u5300B\u6837\u6761"),a.a.createElement(O.a.Button,{value:"/dynamic-b-spline"},"\u52a8\u6001\u53c2\u6570\u7684B\u6837\u6761\u66f2\u7ebf")))},x=(n(268),n(61)),A=n(62),P=(n(350),n(54)),S=(n(272),n(59)),k=(n(274),n(170)),B=n(27),C=[[50,50],[100,70],[200,200],[200,300],[400,400]],I=[0,0,0,1,2,3,3,3];var T=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(null),n=Object(s.a)(t,2),i=n[0],o=n[1],c=Object(r.useState)(3),l=Object(s.a)(c,2),u=l[0],p=l[1],f=Object(r.useState)(Object(B.cloneDeep)(C)),d=Object(s.a)(f,2),m=d[0],g=d[1],v=Object(r.useState)(Object(B.cloneDeep)(I)),y=Object(s.a)(v,2),E=y[0],j=y[1];Object(r.useEffect)((function(){e.current&&null==i&&o(h.a.init(e.current,{renderer:"canvas"}))}),[e.current]);var O=function(){if(null!=i&&null!=u){i.clear();try{for(var e=new b({points:Object(B.cloneDeep)(m),tArray:E,order:u}),t=[],n=0;n<=e.tArray[e.tArray.length-1];n+=.05){var r=e.getPoint(n);t.push(r)}var a=new h.a.Polyline({shape:{points:t}});i.add(a),m.forEach((function(t,n){var r=new h.a.Circle({shape:{cx:t[0],cy:t[1],r:3},draggable:!0});r.on("drag",(function(t){var r=[t.offsetX,t.offsetY];e.updatePoint(n,r);for(var i=[],o=0;o<=e.tArray[e.tArray.length-1];o+=.01){var c=e.getPoint(o);i.push(c)}a.shape.points=i,a.dirty()})),i.add(r)}))}catch(o){k.a.error({message:"\u7ed8\u5236\u9519\u8bef",description:o.message})}}};return Object(r.useEffect)((function(){i&&O()}),[i]),Object(r.useEffect)((function(){if(u){var e=u+m.length;if(e!==E.length){var t=Object(B.cloneDeep)(E);t.length=e;for(var n=0;n<e;n+=1)void 0===t[n]&&(t[n]=E[E.length-1]);console.log(t),j(t)}}}),[u,m]),a.a.createElement("div",{style:{padding:"16px"}},a.a.createElement("div",{style:{textAlign:"center",marginBottom:"32px"}},"\u81ea\u7531\u53c2\u6570\u7684B\u6837\u6761\u66f2\u7ebf\uff08\u9ed8\u8ba4\u4e3a\u5f00\u653e\u5747\u5300\u4e09\u9636B\u6837\u6761\uff09"),a.a.createElement(P.a,{layout:"inline"},a.a.createElement(P.a.Item,{label:"\u9636\u6570"},a.a.createElement(S.a,{step:1,min:2,value:u,onChange:p})),a.a.createElement(P.a.Item,{label:"\u63a7\u5236\u70b9"},a.a.createElement("div",{style:{textAlign:"center"}},Object(B.map)(m,(function(e,t){return a.a.createElement("div",{style:{display:"flex",marginBottom:"6px"},key:t},a.a.createElement("div",{style:{paddingRight:"6px"}},"x",a.a.createElement("sub",null,t)," ",a.a.createElement(S.a,{value:e[0],onChange:function(e){m[t][0]=e||0,g(Object(A.a)(m))}})),a.a.createElement("div",null,"y",a.a.createElement("sub",null,t)," ",a.a.createElement(S.a,{value:e[1],onChange:function(e){m[t][1]=e||0,g(Object(A.a)(m))}})))})),a.a.createElement(x.a,{onClick:function(){m.push([0,0]),g(Object(A.a)(m))},style:{marginTop:"16px"}},"\u6dfb\u52a0\u63a7\u5236\u70b9"))),a.a.createElement(P.a.Item,{label:"\u53c2\u6570t\u6570\u7ec4"},a.a.createElement(a.a.Fragment,null,Object(B.map)(E,(function(e,t){return a.a.createElement("div",{style:{marginBottom:"6px"},key:t},"t",a.a.createElement("sub",null,t),":"," ",a.a.createElement(S.a,{value:e,onChange:function(e){E[t]=e||0,j(Object(A.a)(E))}}))})))),a.a.createElement(P.a.Item,null,a.a.createElement(x.a.Group,null,a.a.createElement(x.a,{type:"primary",onClick:O},"\u751f\u6210"),a.a.createElement(x.a,{type:"danger",onClick:function(){p(3),g(Object(B.cloneDeep)(C)),j(Object(B.cloneDeep)(I)),O()}},"\u91cd\u7f6e")))),a.a.createElement("div",{ref:e,style:{width:"100%",height:"600px"}}))},R=function(){return a.a.createElement(c.a,null,a.a.createElement(w,null),a.a.createElement(l.c,null,a.a.createElement(l.a,{path:"/uniform-b-spline-of-order-3",component:y}),a.a.createElement(l.a,{path:"/open-uniform-b-spline",component:j}),a.a.createElement(l.a,{path:"/dynamic-b-spline",component:T})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[171,1,2]]]);
//# sourceMappingURL=main.1a6031a1.chunk.js.map